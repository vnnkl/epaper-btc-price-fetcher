#include <WiFi.h>
#include <WiFiClientSecure.h>

#include <ArduinoJson.h>
#include <GxEPD2_BW.h>
#include <GxEPD2_3C.h>
#include <Fonts/FreeSansBold18pt7b.h>


char wifiSSID[] = "WiFi SSID";
char wifiPASS[] = "password";

GxEPD2_3C<GxEPD2_270c, GxEPD2_270c::HEIGHT> display(GxEPD2_270c(/*CS=5*/ SS, /*DC=*/ 22, /*RST=*/ 21, /*BUSY=*/ 4));

const char* host = "api.opennode.co";
const int httpsPort = 443;
String on_currency = "BTCUSD";
String on_currency2 = "BTCEUR";
String priceUSD;
String priceEUR;

const char* wl_status_to_string(wl_status_t status) {
  switch (status) {
    case WL_NO_SHIELD: return "WL_NO_SHIELD";
    case WL_IDLE_STATUS: return "WL_IDLE_STATUS";
    case WL_NO_SSID_AVAIL: return "WL_NO_SSID_AVAIL";
    case WL_SCAN_COMPLETED: return "WL_SCAN_COMPLETED";
    case WL_CONNECTED: return "WL_CONNECTED";
    case WL_CONNECT_FAILED: return "WL_CONNECT_FAILED";
    case WL_CONNECTION_LOST: return "WL_CONNECTION_LOST";
    case WL_DISCONNECTED: return "WL_DISCONNECTED";
  }
}

const unsigned char logo [] PROGMEM = {
  // 'BC_Logo_, 200x42px
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xe3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xc7, 0x1f, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xc7, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x46, 0x3f, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x06, 0x3f, 0xff, 0xf0, 0x00, 0x0f, 0xe0, 0x00, 0x1f, 0xc0,
  0x7f, 0x00, 0x01, 0xf0, 0x00, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00,
  0x3f, 0xff, 0xf0, 0x00, 0x03, 0xe0, 0x00, 0x0f, 0xc0, 0x7c, 0x00, 0x01, 0xf0, 0x00, 0x07, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0x0f, 0xff, 0xf0, 0x00, 0x03, 0xe0, 0x00,
  0x07, 0xc0, 0x7c, 0x00, 0x01, 0xe0, 0x00, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xfe, 0x00, 0x07, 0xff, 0xf0, 0x00, 0x03, 0xe0, 0x00, 0x07, 0xc0, 0x78, 0x00, 0x03, 0xe0, 0x00,
  0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x0e, 0x01, 0xff, 0xf0, 0x18, 0x03,
  0xe0, 0x60, 0x07, 0xc0, 0xf8, 0x00, 0x03, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xfc, 0x0f, 0x81, 0xff, 0xf0, 0x3f, 0x03, 0xc0, 0x7c, 0x0f, 0xc0, 0xf8, 0x0f, 0xff,
  0xe0, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x1f, 0xc0, 0xff, 0xe0,
  0x3f, 0x03, 0xc0, 0x7c, 0x0f, 0xc0, 0xf8, 0x1f, 0xff, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xfc, 0x1f, 0xc0, 0xff, 0xe0, 0x3f, 0x03, 0xc0, 0xfc, 0x0f, 0xc0, 0xf8,
  0x1f, 0xff, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x1f, 0xc0,
  0xff, 0xe0, 0x3f, 0x03, 0xc0, 0xf8, 0x0f, 0x80, 0xf8, 0x1f, 0xff, 0xc0, 0x7f, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x1f, 0x81, 0xff, 0xe0, 0x3f, 0x07, 0xc0, 0xf8, 0x0f,
  0x80, 0xf0, 0x1f, 0xff, 0xc0, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8,
  0x00, 0x01, 0xff, 0xe0, 0x7e, 0x07, 0x80, 0xf0, 0x1f, 0x80, 0xf0, 0x1f, 0xff, 0xc0, 0x00, 0x0f,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00, 0x03, 0xff, 0xe0, 0x30, 0x07, 0x80,
  0x00, 0x1f, 0x80, 0xf0, 0x3f, 0xff, 0xc0, 0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xf8, 0x00, 0x07, 0xff, 0xc0, 0x00, 0x0f, 0x80, 0x00, 0x3f, 0x81, 0xf0, 0x3f, 0xff, 0x80,
  0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x38, 0x07, 0xff, 0xc0, 0x00,
  0x0f, 0x00, 0x00, 0xff, 0x81, 0xf0, 0x3f, 0xff, 0x80, 0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xf0, 0x7f, 0x03, 0xff, 0xc0, 0x00, 0x1f, 0x00, 0x01, 0xff, 0x01, 0xe0, 0x3f,
  0xff, 0x81, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x7f, 0x81, 0xff,
  0xc0, 0x00, 0x3f, 0x00, 0x01, 0xff, 0x01, 0xe0, 0x3f, 0xff, 0x81, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x7f, 0x81, 0xff, 0x80, 0xff, 0xfe, 0x00, 0x01, 0xff, 0x03,
  0xe0, 0x3f, 0xff, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x7f,
  0x81, 0xff, 0x80, 0xff, 0xfe, 0x02, 0x01, 0xff, 0x03, 0xe0, 0x3f, 0xff, 0x03, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0xff, 0x81, 0xff, 0x81, 0xff, 0xfe, 0x03, 0x00,
  0xfe, 0x03, 0xe0, 0x00, 0x0f, 0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,
  0x00, 0x3f, 0x01, 0xff, 0x01, 0xff, 0xfc, 0x07, 0x80, 0xfe, 0x07, 0xc0, 0x00, 0x1e, 0x03, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x03, 0xff, 0x01, 0xff, 0xfc,
  0x07, 0x80, 0xfe, 0x07, 0xc0, 0x00, 0x1e, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xf0, 0x00, 0x03, 0xff, 0x03, 0xff, 0xf8, 0x0f, 0x80, 0x7c, 0x07, 0xc0, 0x00, 0x1c,
  0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x07, 0xfe, 0x03,
  0xff, 0xf8, 0x0f, 0xc0, 0x7c, 0x0f, 0xc0, 0x00, 0x1c, 0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xf1, 0x80, 0x1f, 0xfe, 0x07, 0xff, 0xf0, 0x1f, 0xc0, 0x78, 0x0f, 0xe0,
  0x00, 0x3c, 0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf1, 0x8f, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf1, 0x8f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf3,
  0x8f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x8f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
};

const unsigned char logo_grey [] PROGMEM = {
// 'BC_Logotype_grey', 200x50px
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0x7f, 0xff, 0xff, 0xff, 0xcf, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00,
0x07, 0xff, 0xff, 0xf0, 0x0f, 0xff, 0xff, 0xc1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0x83, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x01, 0xff, 0xff, 0xf0, 0x1f, 0xff, 0xff,
0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x01, 0xff, 0xff, 0xff, 0xff,
0x80, 0x00, 0x00, 0xff, 0xff, 0xe0, 0x1f, 0xff, 0xff, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xfe, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x3f, 0xff, 0xe0, 0x1f,
0xff, 0xfe, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0xff, 0xff,
0xff, 0xfe, 0x00, 0x00, 0x00, 0x1f, 0xff, 0xe0, 0x1f, 0xff, 0xfe, 0x00, 0x7f, 0xe7, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0xff, 0xff, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x0f, 0xff,
0xe0, 0x3f, 0xff, 0xfe, 0x00, 0xf8, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x01,
0xff, 0xff, 0xff, 0xf8, 0x00, 0x00, 0x00, 0x07, 0xff, 0xc0, 0x3f, 0xff, 0xfe, 0x00, 0xf8, 0x07,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x01, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x0c, 0x00,
0x03, 0xff, 0xc0, 0x3f, 0xff, 0xff, 0x01, 0xf8, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xfe, 0x03, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x1c, 0xc0, 0x03, 0xff, 0xc0, 0x3f, 0xff, 0xff, 0x87,
0xf0, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x0f, 0xff, 0xff, 0xff, 0xe0, 0x03,
0x9d, 0xc0, 0x01, 0xff, 0xc0, 0x7f, 0xff, 0xff, 0xff, 0xf0, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xc0, 0x03, 0xfd, 0xc0, 0x00, 0xff, 0xc0, 0x7f, 0xff,
0xff, 0xff, 0xf0, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xc0, 0x03, 0xff, 0xc0, 0x00, 0xff, 0x80, 0x7f, 0xff, 0xff, 0xff, 0xf0, 0x1f, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0x00, 0xff, 0xf0, 0x00, 0xff, 0x80,
0x40, 0x7f, 0xfc, 0x03, 0xe0, 0x00, 0x0f, 0xfe, 0x00, 0x3f, 0xfc, 0x00, 0xff, 0xf8, 0x07, 0xfe,
0x00, 0x1f, 0x80, 0x00, 0xff, 0xf8, 0x00, 0x7f, 0x80, 0x00, 0x1f, 0xfc, 0x03, 0xe0, 0x00, 0x0f,
0xf0, 0x00, 0x0f, 0xf0, 0x00, 0x3f, 0xf8, 0x07, 0xe0, 0x00, 0x07, 0x80, 0x00, 0xf8, 0xfc, 0x00,
0x7f, 0x80, 0x00, 0x0f, 0xfc, 0x03, 0xe0, 0x00, 0x1f, 0xe0, 0x00, 0x1f, 0xc0, 0x00, 0x1f, 0xf8,
0x07, 0xe0, 0x00, 0x03, 0x00, 0x00, 0xf0, 0x7c, 0x00, 0x7f, 0x00, 0x00, 0x07, 0xfc, 0x07, 0xe0,
0x00, 0x1f, 0x80, 0x00, 0x1f, 0x80, 0x00, 0x0f, 0xf8, 0x0f, 0xc0, 0x00, 0x01, 0x00, 0x00, 0xf0,
0x7c, 0x00, 0x7f, 0x00, 0x00, 0x03, 0xf8, 0x07, 0xc0, 0x00, 0x1f, 0x00, 0x00, 0x3f, 0x00, 0x00,
0x0f, 0xf0, 0x0f, 0xc0, 0x00, 0x01, 0x00, 0x01, 0xf0, 0x7c, 0x00, 0x3f, 0x00, 0x00, 0x03, 0xf8,
0x07, 0xc0, 0x00, 0x1f, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x07, 0xf0, 0x0f, 0xc0, 0x00, 0x00, 0x00,
0x01, 0xff, 0xfc, 0x00, 0x3f, 0x00, 0x78, 0x03, 0xf8, 0x07, 0xc0, 0x00, 0x3e, 0x00, 0x3e, 0x3e,
0x00, 0x70, 0x07, 0xf0, 0x0f, 0xc0, 0x3c, 0x00, 0x00, 0x01, 0xff, 0xf8, 0x00, 0x3e, 0x01, 0xfc,
0x01, 0xf8, 0x0f, 0xc0, 0x7f, 0xfc, 0x00, 0xff, 0xfc, 0x01, 0xf8, 0x03, 0xf0, 0x1f, 0x80, 0x7f,
0x00, 0x00, 0x01, 0xff, 0xf0, 0x00, 0x3e, 0x01, 0xfe, 0x01, 0xf0, 0x0f, 0xc0, 0x7f, 0xfc, 0x03,
0xff, 0xf8, 0x03, 0xfc, 0x03, 0xe0, 0x1f, 0x80, 0x7f, 0x00, 0x00, 0x03, 0xe1, 0xf8, 0x00, 0x3e,
0x01, 0xfe, 0x01, 0xf0, 0x0f, 0x80, 0x7f, 0xf8, 0x03, 0xff, 0xf8, 0x07, 0xfc, 0x03, 0xe0, 0x1f,
0x80, 0x7f, 0x00, 0x00, 0x03, 0xe0, 0xf8, 0x00, 0x3e, 0x03, 0xfe, 0x01, 0xf0, 0x0f, 0x80, 0x7f,
0xf8, 0x07, 0xff, 0xf8, 0x07, 0xfc, 0x03, 0xe0, 0x1f, 0x80, 0x7f, 0x00, 0x00, 0x03, 0xc0, 0x7c,
0x00, 0x7c, 0x03, 0xfe, 0x01, 0xf0, 0x1f, 0x80, 0xff, 0xf0, 0x07, 0xff, 0xf0, 0x0f, 0xfc, 0x03,
0xe0, 0x1f, 0x80, 0xff, 0x00, 0x00, 0x1f, 0xc0, 0x7c, 0x00, 0x7c, 0x03, 0xfe, 0x01, 0xf0, 0x1f,
0x80, 0xff, 0xf0, 0x0f, 0xff, 0xf0, 0x0f, 0xfc, 0x03, 0xc0, 0x3f, 0x00, 0xff, 0x00, 0x80, 0x3f,
0xe0, 0xf8, 0x00, 0x7c, 0x03, 0xfe, 0x01, 0xe0, 0x1f, 0x00, 0xff, 0xf0, 0x0f, 0xff, 0xf0, 0x0f,
0xfc, 0x03, 0xc0, 0x3f, 0x00, 0xfe, 0x01, 0x80, 0x1f, 0xff, 0xf8, 0x00, 0x7c, 0x03, 0xfe, 0x01,
0xe0, 0x1f, 0x00, 0xff, 0xf0, 0x0f, 0xff, 0xf0, 0x1f, 0xfc, 0x03, 0xc0, 0x3f, 0x00, 0xfe, 0x01,
0x80, 0x03, 0xff, 0xf8, 0x00, 0xf8, 0x07, 0xfe, 0x03, 0xe0, 0x1f, 0x00, 0xff, 0xf0, 0x0f, 0xff,
0xf0, 0x1f, 0xfc, 0x07, 0xc0, 0x3f, 0x01, 0xfe, 0x01, 0xc0, 0x03, 0xbf, 0xf0, 0x00, 0xf8, 0x07,
0xfc, 0x03, 0xe0, 0x3f, 0x01, 0xff, 0xf0, 0x0f, 0xff, 0xe0, 0x1f, 0xf8, 0x07, 0xc0, 0x7e, 0x01,
0xfe, 0x01, 0xc0, 0x03, 0x98, 0x00, 0x00, 0xf8, 0x07, 0xfc, 0x03, 0xc0, 0x3e, 0x01, 0xff, 0xf0,
0x0f, 0xff, 0xe0, 0x1f, 0xf8, 0x07, 0x80, 0x7e, 0x01, 0xfe, 0x03, 0xe0, 0x03, 0x38, 0x00, 0x01,
0xf8, 0x07, 0xf8, 0x07, 0xc0, 0x3e, 0x01, 0xff, 0xf0, 0x0f, 0xff, 0xe0, 0x1f, 0xf8, 0x07, 0x80,
0x7e, 0x01, 0xfc, 0x03, 0xe0, 0x01, 0x38, 0x00, 0x03, 0xf8, 0x0f, 0xf0, 0x07, 0xc0, 0x3e, 0x01,
0xff, 0xf0, 0x0f, 0xff, 0xf0, 0x1f, 0xf0, 0x0f, 0x80, 0x7e, 0x03, 0xfc, 0x03, 0xf0, 0x00, 0x10,
0x00, 0x03, 0xf0, 0x0f, 0xe0, 0x0f, 0xc0, 0x7e, 0x01, 0xff, 0xf0, 0x07, 0xff, 0xf0, 0x0f, 0xe0,
0x0f, 0x80, 0xfc, 0x03, 0xfc, 0x03, 0xf8, 0x00, 0x00, 0x00, 0x07, 0xf0, 0x0f, 0xc0, 0x0f, 0x80,
0x7e, 0x00, 0xfe, 0xf0, 0x03, 0xfd, 0xf0, 0x07, 0xc0, 0x1f, 0x00, 0xfc, 0x03, 0xfc, 0x07, 0xfc,
0x00, 0x00, 0x00, 0x0f, 0xf0, 0x00, 0x00, 0x1f, 0x80, 0x7e, 0x00, 0x00, 0xf8, 0x00, 0x01, 0xf0,
0x00, 0x00, 0x1f, 0x00, 0xfc, 0x03, 0xf8, 0x07, 0xfe, 0x00, 0x00, 0x00, 0x1f, 0xf0, 0x00, 0x00,
0x3f, 0x80, 0x7e, 0x00, 0x00, 0xf8, 0x00, 0x01, 0xf8, 0x00, 0x00, 0x3f, 0x00, 0xfc, 0x07, 0xf8,
0x07, 0xff, 0x00, 0x00, 0x00, 0x3f, 0xe0, 0x00, 0x00, 0x7f, 0x80, 0xff, 0x00, 0x00, 0xfc, 0x00,
0x01, 0xf8, 0x00, 0x00, 0x7f, 0x01, 0xf8, 0x07, 0xf8, 0x07, 0xff, 0x80, 0x00, 0x00, 0xff, 0xe0,
0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0x00, 0xfe, 0x00, 0x01, 0xfc, 0x00, 0x00, 0xfe, 0x01, 0xf8,
0x07, 0xf8, 0x0f, 0xff, 0xe0, 0x00, 0x01, 0xff, 0xe0, 0x00, 0x03, 0xff, 0x00, 0xff, 0x80, 0x00,
0xff, 0x00, 0x01, 0xfe, 0x00, 0x03, 0xfe, 0x01, 0xf8, 0x07, 0xf0, 0x0f, 0xff, 0xf8, 0x00, 0x0f,
0xff, 0xf0, 0x00, 0x0f, 0xff, 0x00, 0xff, 0xc0, 0x00, 0xff, 0x80, 0x01, 0xff, 0x00, 0x07, 0xfe,
0x01, 0xf8, 0x0f, 0xf0, 0x0f, 0xff, 0xff, 0x80, 0x7f, 0xff, 0xff, 0x80, 0x7f, 0xff, 0xff, 0xff,
0xf8, 0x0f, 0xff, 0xf0, 0x0f, 0xff, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
0xff, 0xff
};



void setup() {
  // put your setup code here, to run once:

  Serial.begin(115200);

  WiFi.begin(wifiSSID, wifiPASS);
  while (WiFi.status() != WL_CONNECTED) {
    Serial.println("connecting");
    Serial.println(wl_status_to_string(WiFi.status()));
    delay(500);
  }

  Serial.println("connected");

  display.init(115200);
  display.setRotation(3);
  display.setFont(&FreeSansBold18pt7b);
  display.setTextColor(GxEPD_RED);

  ONprice();

  display.firstPage();
  do
  {
    display.fillScreen(GxEPD_WHITE);
    display.drawInvertedBitmap(20, 20, logo_grey, 200, 50, GxEPD_BLACK);
    display.setCursor(0, 120);

    display.print("  "+priceUSD+" USD\n");
    display.print("  "+priceEUR+" EUR");
  }
  while (display.nextPage());
}

void ONprice() {
  WiFiClientSecure client;

  if (!client.connect(host, httpsPort)) {

    return;
  }

  String url = "/v1/rates";


  client.print(String("GET ") + url + " HTTP/1.1\r\n" +
               "Host: " + host + "\r\n" +
               "User-Agent: ESP32\r\n" +
               "Connection: close\r\n\r\n");

  while (client.connected()) {
    String line = client.readStringUntil('\n');
    if (line == "\r") {

      break;
    }
  }
  String line = client.readStringUntil('\n');

  const size_t capacity = 169 * JSON_OBJECT_SIZE(1) + JSON_OBJECT_SIZE(168) + 3800;

  DynamicJsonBuffer jsonBuffer(capacity);

  JsonObject& root = jsonBuffer.parseObject(line);

  JsonObject& data = root["data"];

  String temp = data[on_currency][on_currency.substring(3)];
  priceUSD = temp;
  String temp2 = data[on_currency2][on_currency2.substring(3)];
  priceEUR = temp2;
  Serial.println(priceUSD);
  Serial.println(priceEUR);
}

void loop() {
  // put your main code here, to run repeatedly:

}
